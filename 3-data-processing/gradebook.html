<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gradebook</title>
</head>
<body>

    <h1>Gradebook</h1>
    <a href="../index.html">Home</a>

    <h2>Part 1</h2>
    <p>
        JavaScript logic to process gradebook data.
    </p>

    <hr>
    <h2>Part 2</h2>
    <p>
        JavaScript code to populate a table with gradebook info.
    </p>

    <table id="display-gradebook" border="1" style="border-collapse: collapse; margin-top: 1em;">
    </table>

    <script src="https://d3js.org/d3-array.v2.min.js"></script>
    <script type="text/javascript">

        var gradebook = {
            "downloadDate": "2021-06-05",
            "professorId": 123,
            "students":[
                {"studentId": 1, "name": "Student 1", "finalGrade": 76.7},
                {"studentId": 2, "name": "Student 2", "finalGrade": 85.1},
                {"studentId": 3, "name": "Student 3", "finalGrade": 50.3},
                {"studentId": 4, "name": "Student 4", "finalGrade": 89.8},
                {"studentId": 5, "name": "Student 5", "finalGrade": 97.4},
                {"studentId": 6, "name": "Student 6", "finalGrade": 75.5},
                {"studentId": 7, "name": "Student 7", "finalGrade": 87.2},
                {"studentId": 8, "name": "Student 8", "finalGrade": 88.0},
                {"studentId": 9, "name": "Student 9", "finalGrade": 93.9},
                {"studentId": 10, "name": "Student 10", "finalGrade": 92.5}
            ]
        }

        console.log("---------------------")
        console.log("PART 1...")

        // A. Display the download date
        console.log("A. Download Date:", gradebook.downloadDate)

        // B. Number of students
        console.log("B. Number of Students:", gradebook.students.length)

        // C. Loop through students and display name + grade
        console.log("C. Student Grades:")
        gradebook.students.forEach(student => {
            console.log(`${student.name}: ${student.finalGrade}`)
        })

        // D. Map to numeric grades
        const grades = gradebook.students.map(student => student.finalGrade)
        console.log("D. Grades Array:", grades)

        // E. Average grade using d3.mean
        const avgGrade = d3.mean(grades)
        console.log("E. Average Grade:", avgGrade.toFixed(2))

        // F. Median grade using d3.median
        const medianGrade = d3.median(grades)
        console.log("F. Median Grade:", medianGrade.toFixed(2))


        console.log("---------------------")
        console.log("PART 2...")

        // Get table element
        const table = document.getElementById("display-gradebook");

        // Create header row
        const headerRow = table.insertRow();
        ["Student ID", "Student Name", "Final Grade"].forEach(header => {
            const th = document.createElement("th");
            th.textContent = header;
            headerRow.appendChild(th);
        });

        // Create one row per student
        gradebook.students.forEach(student => {
            const row = table.insertRow();
            row.insertCell().textContent = student.studentId;
            row.insertCell().textContent = student.name;
            row.insertCell().textContent = student.finalGrade.toFixed(1);
        });

    </script>

</body>
</html>
